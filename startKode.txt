library(shiny)library(ggsoccer)library(ggplot2)library(dplyr)library(stringr)library(DT)#source("util.R")classallSP = readRDS("allshotsandplayers.rds")ui <- fluidPage(  tabsetPanel(    tabPanel("Spiller stats",             selectInput("sp",                         "vælg num var",                         choices = c("age","bmi"),                         selected = "age"             ),             plotOutput("spplot")    ),    tabPanel("Målfarlighed med vinkel eller afstand ",             selectInput("snum",                         "vælg num var forhold til mål",                         choices = c("myang","mdist"),                         selected = "myang"             ),             plotOutput("skplot")    ),    tabPanel("Målfarlighed for Hold eller position ",             selectInput("skat",                         "vælg kat var forhold til mål",                         choices = c("position","team.name"),                         selected = "position"             ),             plotOutput("skatplot")    ),    tabPanel("Skud pr spiller ",             selectInput("sp",                         "vælg spiller",                         choices = c("Kurt","Verner"),                         selected = "Kurt"             ),             plotOutput("shotplot")    )   ))server <- function(input, output, session) {  shots <- data.frame(x = c(90, 85, 82, 78, 83, 74, 94, 91),                      y = c(43, 40, 52, 56, 44, 71, 60, 54))  output$spplot <- renderPlot({    xval=sym(input$sp)    ggplot(classallSP,aes(x=!!xval))+geom_histogram()  })    output$skplot <- renderPlot({    xval=sym(input$sp)    ggplot(classallSP,aes(x=!!xval))+geom_histogram()  })    output$skatplot <- renderPlot({    xval=input$skat    cval="isGoal"    ggplot(classallSP,aes_string(x=xval, color=cval))+geom_bar()  })    output$shotplot <- renderPlot({    ggplot(data=shots) +      annotate_pitch(        dimensions = pitch_wyscout,        colour = "white",        fill = "#3ab54a")+      geom_point(aes(x = x, y = y),                 size = 2) +      theme_pitch() +      direction_label() +      ggtitle("Simple passmap Taylor",               "ggsoccer example")  })}shinyApp(ui, server)